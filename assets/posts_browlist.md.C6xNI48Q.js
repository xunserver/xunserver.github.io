import{_ as a,c as r,o as t,ah as s}from"./chunks/framework.BurO9VyR.js";const d=JSON.parse('{"title":"browlist","description":null,"frontmatter":{"title":"browlist","comments":true,"hide":false,"abbrlink":"5bc71ff9","date":"2022-07-21T09:39:49.000Z","updated":"2022-07-21T09:39:49.000Z","tags":null,"categories":null,"description":null},"headers":[],"relativePath":"posts/browlist.md","filePath":"posts/browlist.md"}'),l={name:"posts/browlist.md"};function o(i,e,n,b,h,c){return t(),r("div",null,e[0]||(e[0]=[s('<h3 id="作用" tabindex="-1">作用 <a class="header-anchor" href="#作用" aria-label="Permalink to &quot;作用&quot;">​</a></h3><p>配置当前项目面向的平台，可以帮助babel、postcss识别出当前内容中哪些是需要转换</p><h3 id="配置" tabindex="-1">配置 <a class="header-anchor" href="#配置" aria-label="Permalink to &quot;配置&quot;">​</a></h3><p>支持字符串和对象的配置防范，对于字符串的配置可以使用npx browserlist string 检查字符串配置是否有效。 &quot;,&quot; 表示并集 and表示交集</p><h3 id="browserslist-webpack插件" tabindex="-1">browserslist webpack插件 <a class="header-anchor" href="#browserslist-webpack插件" aria-label="Permalink to &quot;browserslist webpack插件&quot;">​</a></h3><h4 id="需求" tabindex="-1">需求 <a class="header-anchor" href="#需求" aria-label="Permalink to &quot;需求&quot;">​</a></h4><ol><li>页面加载时判断当前浏览器是否在兼容列表中，如果不存在，提示浏览器版本过低</li><li>离线判断，判断编译到代码中</li><li>打包时如果使用的浏览器是低版本，用户的浏览器高于高于这个版本处理。</li><li>如果webpack打包的环境不具备联网功能，需要支持手动上传查询文件功能</li></ol><h4 id="技术预研" tabindex="-1">技术预研 <a class="header-anchor" href="#技术预研" aria-label="Permalink to &quot;技术预研&quot;">​</a></h4><ol><li>离线判断需要编写webpack 插件，在生产打包时动态的查询然后将结果编译成chunk吗，并在入口文件中引用并提示。</li><li>不能在每个页面都做判断逻辑，能不能只判断依次，然后将结果缓存起来。</li></ol><p>基于上面的逻辑找到了一个好东西 <a href="https://github.com/browserslist/browserslist-useragent-regexp%EF%BC%8C%E8%BF%99%E4%B8%AA%E5%BA%93%E5%8F%AF%E4%BB%A5%E6%A0%B9%E6%8D%AE%E9%85%8D%E7%BD%AE%E7%94%9F%E6%88%90" target="_blank" rel="noreferrer">https://github.com/browserslist/browserslist-useragent-regexp，这个库可以根据配置生成</a> js 正则表达式，不过这个库的查询逻辑是自行实现的，不支持用户实现查询好浏览器后手动添加。</p><h4 id="解决-browserslist-useragent-regexp-缺少的离线查询功能" tabindex="-1">解决 browserslist-useragent-regexp 缺少的离线查询功能 <a class="header-anchor" href="#解决-browserslist-useragent-regexp-缺少的离线查询功能" aria-label="Permalink to &quot;解决 browserslist-useragent-regexp 缺少的离线查询功能&quot;">​</a></h4><p>原作者一直的更新，我们需要改动的只是 /src/browsers/browserslist.ts 中的getBrowsersList代码，新增从本地获取的逻辑。使用git action 每天定期的从原仓库拉取代码，如果有新的tag，将原始代码和本地代码混合， 重新打包发布新的。</p><h4 id="" tabindex="-1"><a class="header-anchor" href="#" aria-label="Permalink to &quot;&quot;">​</a></h4>',13)]))}const u=a(l,[["render",o]]);export{d as __pageData,u as default};
